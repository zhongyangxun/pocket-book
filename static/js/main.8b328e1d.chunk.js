(this["webpackJsonppocket-book"]=this["webpackJsonppocket-book"]||[]).push([[0],{161:function(e,t,a){},162:function(e,t,a){},165:function(e,t,a){"use strict";a.r(t);var n,c=a(0),r=a.n(c),l=a(11),o=a.n(l),i=(a(84),a(9)),m=a(7),s=function(){return r.a.createElement("header",{className:"header bg-dark"},r.a.createElement("nav",{className:"navbar navbar-expand-lg container text-light"},r.a.createElement("span",{className:"navbar-brand mb-0 h1"},"Pocket Book")))};!function(e){e.Income="1",e.Expenditure="0"}(n||(n={}));var u=function(e){var t=e.type,a=e.time,c=e.category,l=e.amount,o=t===n.Income?"+":"-";return l<0&&(o=""),r.a.createElement("li",{className:"bill-item list-group-item"},r.a.createElement("div",{className:"category"},c),r.a.createElement("div",{className:"time"},a),r.a.createElement("div",{className:"amount"},"".concat(o).concat(l.toFixed(2))))},d=function(e){var t=e.text;return r.a.createElement("div",{className:"loading text-center"},r.a.createElement("div",{className:"loading-icon"},r.a.createElement("div",{className:"spinner-border"})),t&&r.a.createElement("span",{className:"text"},t))};d.defaultProps={text:"\u52a0\u8f7d\u4e2d..."};var b=d,f=a(22),v=a(18),E=function(e){var t=e.text;return r.a.createElement("div",{className:"no-data text-center my-3"},r.a.createElement("div",{className:"icon text-black-50"},r.a.createElement(f.a,{icon:v.c,size:"6x"})),r.a.createElement("p",{className:"text text-secondary"},t))};E.defaultProps={text:"\u6682\u65e0\u6570\u636e"};var p=E,g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.hasDay,n=void 0===a||a,c=e.getFullYear(),r="".concat(e.getMonth()+1).padStart(2,"0");if(n){var l="".concat(e.getDate()).padStart(2,"0");return[c,r,l].join("-")}return[c,r].join("-")},y=function(e){return g(e,{hasDay:!1})},h=(a(89),function(e){var t=e.list,a=e.loading;return r.a.createElement("ul",{className:"bill-list container list-group list-group-flush my-3 p-3 bg-white rounded shadow-sm","data-testid":"bill-list"},a&&r.a.createElement(b,null),!a&&0===t.length&&r.a.createElement(p,null),!a&&t.map((function(e){return r.a.createElement(u,{key:e.id,amount:parseFloat(e.amount),type:e.type,category:e.categoryName,time:g(new Date(e.time))})})))}),N=a(12),j=a.n(N),O=a(34),x=a.n(O),w=a(41),k=a(8),F=a(44),S=a.n(F),C="".concat("http://47.95.241.143:5000","/bill"),T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.time,a=e.category;return S.a.get("".concat(C,"/list"),{params:{time:t,category:a}})},D=function(e){var t=e.placeholderText,a=e.billType,n=Object(w.a)(e,["placeholderText","billType"]),l=Object(c.useState)([]),o=Object(m.a)(l,2),i=o[0],s=o[1];return Object(c.useEffect)((function(){S.a.get("".concat(C,"/categories")).then((function(e){s(e.data)})).catch((function(e){window.console.error(e)}))}),[]),r.a.createElement("select",Object.assign({},n,{"data-testid":"category-select"}),r.a.createElement("option",{value:""},t),i.map((function(e){var t=e.id,n=e.name,c=e.type;return a?a===c?r.a.createElement("option",{value:t,key:t},n):null:r.a.createElement("option",{value:t,key:t},n)})))};D.defaultProps={placeholderText:"\u8bf7\u9009\u62e9\u5206\u7c7b"};var P=D,M=Object(c.createContext)({}),I=function(e){var t=e.className,a=j()("form-inline",t),n=Object(c.useContext)(M),l=n.loading,o=n.month,i=n.category,m=n.changeMonth,s=n.changeCategory,u=n.getBillList,d=function(){if(u){var e={time:o?new Date(o).getTime():void 0,category:i};u(e)}};return r.a.createElement("div",{className:a,"data-testid":"test-filter"},r.a.createElement("div",{className:"form-row align-items-left"},r.a.createElement("div",{className:"form-group mx-2"},r.a.createElement("label",{htmlFor:"filter-month"},"\u6708\u4efd"),r.a.createElement(x.a,{onChange:function(e){m&&(m(y(e)),d())},className:"form-control mx-sm-3",value:o,showMonthYearPicker:!0,maxDate:new Date,id:"filter-month"})),r.a.createElement("div",{className:"form-group mx-2"},r.a.createElement("label",{htmlFor:"filter-category"},"\u5206\u7c7b"),r.a.createElement(P,{className:"form-control mx-sm-3",placeholderText:"\u5168\u90e8",value:i,onChange:function(e){var t=e.target.value;s&&(s(t),d())},disabled:l,id:"filter-category"}))))},B=a(170),L=function(e){var t=e.children,a=e.className,n=e.animation,c=(e.wrapper,Object(w.a)(e,["children","className","animation","wrapper"])),l=r.a.useRef(null);return r.a.createElement(B.a,Object.assign({nodeRef:l,classNames:a||n},c),r.a.createElement("div",{ref:l},t))};L.defaultProps={unmountOnExit:!0,appear:!0};var q=L,z=function(e){var t=e.visible;return o.a.createPortal(r.a.createElement(q,{in:t,timeout:300,animation:"fade-in"},r.a.createElement("div",{className:"modal-backdrop show"})),document.body)},A=function(e){var t,a=e.visible,n=e.children,l=e.closable,o=e.title,m=e.cancelText,s=e.okText,u=e.showFooter,d=e.modalSize,b=e.center,f=e.onOk,v=e.onCancel;Object(c.useEffect)((function(){a?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open")}),[a]);var E,p={display:"block",pointerEvents:a?"unset":"none"},g=function(e){v&&v(e)},y=j()("modal",{visible:a}),h=j()("modal-dialog",(t={},Object(i.a)(t,"modal-".concat(d),!!d),Object(i.a)(t,"modal-dialog-centered",b),t));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:y,style:p,"data-testid":"test-modal"},r.a.createElement(q,{in:a,timeout:300,animation:"zoom-in-top"},r.a.createElement("div",{className:h},r.a.createElement("div",{className:"modal-content"},(E=l,o||E?r.a.createElement("div",{className:"modal-header"},r.a.createElement("div",{className:"modal-title"},o),E&&r.a.createElement("button",{type:"button",className:"close",onClick:g},r.a.createElement("span",null,"\xd7"))):null),r.a.createElement("div",{className:"modal-body"},n),u&&r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:g},m),r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(e){f&&f(e)}},s)))))),r.a.createElement(z,{visible:a}))};A.defaultProps={closable:!0,showFooter:!0,cancelText:"Cancel",okText:"OK"};var J,R=A,Y=(a(161),function(e){var t=e.onFinish,a=e.onFail,n=Object(c.useState)({category:"",amount:"",date:g(new Date)}),l=Object(m.a)(n,2),o=l[0],s=l[1],u=Object(c.useState)({category:"",amount:"",date:""}),d=Object(m.a)(u,2),b=d[0],f=d[1],v=Object(c.useState)(!1),E=Object(m.a)(v,2),p=E[0],y=E[1],h=function(e){var t=e.currentTarget,a=t.value,n=t.name;if(s(Object(k.a)(Object(k.a)({},o),{},Object(i.a)({},n,a))),f(Object(k.a)(Object(k.a)({},b),{},Object(i.a)({},n,""))),"amount"===n){/(^(-[1-9]|[1-9])\d*(\.?\d{1,2})?$)|(^(0|-0)\.(\d[1-9]|[1-9]))$/.test(a)||f(Object(k.a)(Object(k.a)({},b),{},Object(i.a)({},n,"\u8bf7\u8f93\u5165\u6570\u5b57\uff08\u53ef\u7cbe\u786e\u5230\u5c0f\u6570\u70b9\u540e\u4e24\u4f4d\uff09")))}},N=function(e){var t=e.currentTarget,a=t.name,n=t.value;b[a]&&!n&&f(Object(k.a)(Object(k.a)({},b),{},Object(i.a)({},a,"")))};return r.a.createElement("form",{className:"bill-form",onSubmit:function(e){if(e.preventDefault(),function(){var e=!Object.values(b).some((function(e){return""!==e}));return Object.entries(o).forEach((function(t){var a=Object(m.a)(t,2),n=a[0];""===a[1]&&(e=!1,f((function(e){return Object(k.a)(Object(k.a)({},e),{},Object(i.a)({},n,"\u8be5\u9879\u4e0d\u80fd\u4e3a\u7a7a"))})))})),e}()){var n=o.category,c=o.date,r=o.amount,l=new Date(c).getTime();y(!0),(s={category:n,time:l,amount:parseFloat(r)},S.a.post("".concat(C,"/addItem"),Object(k.a)({},s))).then((function(e){t&&t(o,e)})).catch((function(e){a&&a(o,e)})).finally((function(){y(!1)}))}var s},noValidate:!0,"data-testid":"test-bill-form"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"add-category"},"\u5206\u7c7b"),r.a.createElement(P,{id:"add-category",className:j()("custom-select",{"is-invalid":!!b.category}),name:"category",value:o.category,onChange:h,onFocus:N,disabled:p}),r.a.createElement("div",{className:"invalid-feedback"},b.category)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"date"},"\u65e5\u671f"),r.a.createElement("div",{className:j()({"is-invalid":!!b.date})},r.a.createElement(x.a,{className:j()("form-control",{"is-invalid":!!b.date}),id:"date",name:"date",maxDate:new Date,required:!0,value:o.date,onChange:function(e){s(Object(k.a)(Object(k.a)({},o),{},{date:g(e)}))},onFocus:N,disabled:p})),r.a.createElement("div",{className:"invalid-feedback"},b.date)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"amount"},"\u91d1\u989d"),r.a.createElement("input",{className:j()("form-control",{"is-invalid":!!b.amount}),type:"text",id:"amount",name:"amount",required:!0,value:o.amount,onChange:h,onFocus:N,disabled:p}),r.a.createElement("div",{className:"invalid-feedback"},b.amount)),r.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:p},p?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"spinner-border spinner-border-sm mr-2"}),"\u6b63\u5728\u63d0\u4ea4..."):"\u63d0\u4ea4"))}),$=a(76),_=a(171),G=function(e){var t=e.text,a=e.type;return r.a.createElement("div",{className:"message my-2 text-center","data-testid":"test-message"},r.a.createElement("div",{className:"message-content d-inline-flex bg-white px-4 py-2 shadow"},r.a.createElement("div",{className:"icon mr-2"},function(e){var t;switch(e){case"success":t=v.a;break;case"danger":t=v.f;break;case"warning":t=v.b;break;case"info":default:t=v.d}return r.a.createElement(f.a,{icon:t,className:"text-".concat(e)})}(a)),r.a.createElement("div",{className:"text"},t)))},K=(a(162),0),V=Date.now(),H=function(){var e=K;return K+=1,"MESSAGE_".concat(V,"_").concat(e)},Q=function(){var e=Object(c.useState)([]),t=Object(m.a)(e,2),a=t[0],n=t[1],l=function(e){var t=e.key;n((function(e){return e.filter((function(e){var a=e.key;return t!==a}))}))};return J=function(e){n((function(t){return[].concat(Object($.a)(t),[e])})),setTimeout((function(){l(e)}),3e3)},Object(c.useEffect)((function(){if(a.length>10){var e=Object(m.a)(a,1)[0];l(e)}}),[a]),r.a.createElement("div",{className:"message-container"},r.a.createElement(_.a,null,a.map((function(e){var t=e.text,a=e.key,n=e.type;return r.a.createElement(q,{timeout:200,in:!0,animation:"slide-in-top",key:a},r.a.createElement(G,{type:n,text:t}))}))))},U=document.querySelector("#message-wrapper");U||((U=document.createElement("div")).className="message-wrapper",U.id="message-wrapper",document.body.append(U)),o.a.render(r.a.createElement(Q,null),U);var W={info:function(e){J({text:e,key:H(),type:"info"})},success:function(e){J({text:e,key:H(),type:"success"})},warning:function(e){J({text:e,key:H(),type:"warning"})},error:function(e){J({text:e,key:H(),type:"danger"})}},X=function(e){var t=e.className,a=Object(c.useState)(!1),n=Object(m.a)(a,2),l=n[0],o=n[1],i=Object(c.useContext)(M),s=i.loading,u=j()("bill-adder",t);return r.a.createElement("div",{className:u,"data-testid":"bill-adder"},r.a.createElement("button",{className:"btn btn-dark",type:"button",onClick:function(){o((function(e){return!e}))},disabled:s},r.a.createElement(f.a,{icon:v.e,className:"mr-1"}),"\u6dfb\u52a0\u8d26\u5355"),r.a.createElement(R,{visible:l,onCancel:function(){o(!1)},showFooter:!1,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",title:"\u6dfb\u52a0\u8d26\u5355"},r.a.createElement(Y,{onFinish:function(e){o(!1),W.success("\u6dfb\u52a0\u6210\u529f\uff01");var t=e.date,a=i.changeMonth,n=i.getBillList,c=y(new Date(t));(a&&a(c),n)&&n({time:new Date(c).getTime()})},onFail:function(){o(!1),W.error("\u6dfb\u52a0\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}})))},Z=n.Income,ee=n.Expenditure,te=function(){var e=Object(c.useContext)(M).summary,t=e[Z],a=e[ee],n=t.toFixed(2),l=a.toFixed(2),o=t-a,i="".concat(o>0?"+":"").concat(o.toFixed(2));return r.a.createElement("div",{className:"summary d-block d-md-flex","data-testid":"test-summary"},r.a.createElement("div",{className:"income mx-2"},r.a.createElement("span",{className:"font-weight-bold"},"\u6536\u5165\uff1a"),r.a.createElement("span",{className:"income-amount"},n)),r.a.createElement("div",{className:"expenditure mx-2"},r.a.createElement("span",{className:"font-weight-bold"},"\u652f\u51fa\uff1a"),r.a.createElement("span",{className:"expenditure-amount"},l)),r.a.createElement("div",{className:"sum mx-2"},r.a.createElement("span",{className:"font-weight-bold"},"\u603b\u8ba1\uff1a"),r.a.createElement("span",{className:"sum-amount"},i)))},ae=function(){return r.a.createElement("div",{className:"tool-bar container my-3 p-3 bg-light bg-white rounded shadow-sm d-lg-flex justify-content-between align-items-center"},r.a.createElement(I,{className:"mb-0 mb-md-2 mb-lg-0"}),r.a.createElement(X,{className:"mb-2 mb-lg-0"}),r.a.createElement(te,null))},ne=function(){var e,t=Object(c.useState)(!1),a=Object(m.a)(t,2),l=a[0],o=a[1],u=Object(c.useState)([]),d=Object(m.a)(u,2),b=d[0],f=d[1],v=Object(c.useState)(""),E=Object(m.a)(v,2),p=E[0],y=E[1],N=g(new Date,{hasDay:!1}),j=Object(c.useState)(N),O=Object(m.a)(j,2),x=O[0],w=O[1],k=Object(c.useState)((e={},Object(i.a)(e,n.Income,0),Object(i.a)(e,n.Expenditure,0),e)),F=Object(m.a)(k,2),S=F[0],C=F[1],D={loading:l,summary:S,category:p,changeCategory:y,month:x,changeMonth:w,getBillList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(!0),T(e).then((function(e){var t=e.data,a=t.list,n=t.typeSummary;f(a),C(n)})).catch((function(e){window.console.error(e)})).finally((function(){o(!1)}))}};return r.a.createElement("div",{className:"App bg-light","data-testid":"test-app"},r.a.createElement(s,null),r.a.createElement(M.Provider,{value:D},r.a.createElement(ae,null),r.a.createElement(h,{list:b,loading:l})))};a(163),a(164);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ne,null)),document.getElementById("root"))},79:function(e,t,a){e.exports=a(165)},84:function(e,t,a){},89:function(e,t,a){}},[[79,1,2]]]);
//# sourceMappingURL=main.8b328e1d.chunk.js.map